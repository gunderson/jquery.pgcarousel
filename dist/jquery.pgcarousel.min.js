/*! jQuery.PGCarousel - v0.1.0 - 2013-11-12
* https://github.com/gunderson/jquery.pgcarousel
* Copyright (c) 2013 Patrick Gunderson; Licensed MIT */
(function(e){e.pgCarousel=function(t,n){var o=this;o.$el=e(t),o.el=t,o.numActivePages=0,o.$el.data("pgCarousel",o),o.init=function(){o.el=t,o.options=e.extend(!0,{},e.pgCarousel.options,n),o.$el=e(this.el),o.generate()},o.generate=function(){o.options.$pages=o.$el.find(".pgCarousel-pages"),o.options.$pages.length||(o.options.$pages=e("<div class='pgCarousel-pages' />"),o.$el.append(o.options.$pages))},o.numPages=function(){return Math.ceil(o.options.$currentSet.length/o.options.pageLength)},o.page=function(e,t){return arguments.length>0?(o.options.currentPageIndex=e,o.showCarouselPage(t)):o.options.currentPageIndex},o.nextPage=function(e){return o.options.currentPageIndex<o.numPages()-1?(o.options.currentPageIndex++,o.showCarouselPage(e)):o.options.loop?(o.options.currentPageIndex=0,o.showCarouselPage(e)):o},o.prevPage=function(e){return o.options.currentPageIndex>0?(o.options.currentPageIndex--,o.showCarouselPage(e)):o.options.loop?(o.options.currentPageIndex=o.numPages()-1,o.showCarouselPage(e)):o},o.findPageWith=function(e){var t=o.options.$currentSet.indexOf(e),n=t/o.options.pageLength>>0;return n},o.removeItem=function(t){return e.isArray(t)||(t=[t]),e.each(t,function(e,t){var n=o.options.$carouselItems.indexOf(t);-1!==n&&o.options.$carouselItems.splice(n,1)}),o},o.addItem=function(t,n){if(n=0===n||n?n:-1,t instanceof jQuery&&t.length>1)return e.each(t,function(t,r){o.addItem(e(r),n+t)}),o;switch(n){case-1:o.options.$carouselItems.push(t);break;case 0:o.options.$carouselItems.unshift(t);break;default:o.options.$carouselItems.splice(n,0,t)}return t.detach(),o.options.filterOptions?o.filterSet(o.options.filterOptions):o.options.$currentSet=o.options.$carouselItems,o},o.filterSet=function(e){for(var t,n=[],r=o.options.$carouselItems,a=-1,i=r.length;i>++a;){t=!0;for(var s in e)r[a].model.get(s)==e[s]||(t=!1);t&&n.push(r[a])}return o.options.$currentSet=n,o},o.showCarouselPage=function(t){o.options.$prevPage=o.options.$page;var n=o.options.$prevPage,r=o.options.currentPageIndex,a=o.options.pageLength,i=o.options.$currentSet,s=o.options.$pages,u=o.options.animationTime,p=o.options.$page=e('<div><div class="pgCarousel-items pgCarousel-content"></div></div>',{id:"pgCarousel-Page-"+r});p.addClass("pgCarousel-page").css({display:"none",position:"absolute"}).data({page:r});var g=0;n&&(console.log(n.data("page"),r,o.numPages()-1),n.data("page")>r&&(0!==r||n.data("page")!==o.numPages()-1)?(console.log("forward"),g=-1):r>n.data("page")&&(r!==o.numPages()-1||0!==n.data("page"))?(console.log("back"),g=1):0===r?(console.log("loop to the front"),g=1):r===o.numPages()-1&&(console.log("loop to the back"),g=-1));var l=r*a,c=i.slice(l,l+a);return e.each(c,function(e,t){p.find(".pgCarousel-items").append(t)}),s.append(p),t?(p.css({display:"block",left:0}),n&&n.detach()):(p.css({display:"block",left:g*s.width()}).animate({left:0},u,"swing"),n&&n.stop().animate({left:-(g*s.width())},u,"swing",function(){e(this).detach()})),o.$el.trigger("change:page",{pageId:r,page:p}),o},o.areCongreuent=function(e,t){var n;if(e===t)return!0;if(!e||!t)return!1;for(n in t)if(e[n]===void 0)return!1;for(n in t)if(t[n])switch(typeof t[n]){case"object":if(!t[n].equals(e[n]))return!1;break;case"function":if(e[n]===void 0||"equals"!=n&&""+t[n]!=""+e[n])return!1;break;default:if(t[n]!=e[n])return!1}else if(e[n])return!1;for(n in e)if(t[n]===void 0)return!1;return!0},o.init()},e.pgCarousel.options={$currentSet:[],$carouselItems:[],prevPageIndex:-1,$prevPage:null,currentPageIndex:0,$page:null,pageLength:1,filterOptions:null,animationTime:1e3,animationIndex:0,$pages:null,loop:!0,transitionIn:function(){},transitionOut:function(){}},e.fn.pgCarousel=function(t){if(t&&"string"==typeof t){var n;if(n=this[0].pgcarousel){if("page"===t)return n.page();if("numPages"===t)return n.numPages();if("carouselItems"===t)return n.options.$carouselItems}}return this.each(function(){var n,o;if((o=this.pgcarousel)||(n=e.extend({},e.pgCarousel.options,t),this.pgcarousel=o=new e.pgCarousel(this,n)),t&&"object"==typeof t){if(e.extend(o.options,t),t.gotoPage||0===t.gotoPage)return o.page(t.gotoPage);if(t.carouselItems)return o.options.$carouselItems=t.carouselItems,o.page(0,!0);if(t.add)return o.addItem(t.add,t.at),o.page(o.options.currentPageIndex,!0);if(t.remove)return o.removeItem(t.remove),o.page(o.options.currentPageIndex,!0);if(t.move){var r=t.move.item;return o.removeItem(r),o.addItem(r,t.move.to),o.page(o.options.currentPageIndex,!0)}if(t.filter)return o.areCongreuent(o.options.filterOptions,t.filter)?this:(o.options.filterOptions=t.filter,o.filterSet(t.filter),o.page(0,!0));if(t.show){var a=o.findPageWith(t.show);return o.page(a,!0)}}else if(t&&"string"==typeof t){if("next"===t)return o.nextPage();if("prev"===t)return o.prevPage()}return this})}})(jQuery);